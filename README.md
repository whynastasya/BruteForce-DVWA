# Отчёт о проделанной практической работе с файлами

## Задание

### 1. Необходимо разработать переборщик паролей для формы в задании Bruteforce на сайте dvwa.local
![вывод](https://github.com/user-attachments/assets/a76e91d8-1a77-4d43-8af8-c9dccfca436d)

Данные пользователей получила с помощью sql инъекции:

![вывод](https://github.com/user-attachments/assets/88093b5d-25b3-4ed8-bc0f-2130520ef142)

### 2. Проанализировать код и сделать кодревью, указав слабые места. Слабость уязвимого кода необходимо указать с использованием метрики CWE

#### Список уязвимостей:

1. **SQL Injection (CWE-89):** данные вставляются напрямую в SQL-запрос без обработки.  
2. **Устаревший алгоритм MD5 для хэширования паролей (CWE-327):** использование слабого алгоритма для хранения паролей.  
3. **XSS (CWE-79):** отсутствие экранирования пользовательских данных перед выводом.  
4. **Глобальные переменные для соединения с базой данных (CWE-526):** использование `$GLOBALS` для хранения соединения.  
5. **Отсутствие защиты от brute-force атак (CWE-307):** отсутствуют ограничения на количество попыток входа.  
6. **Использование ненадёжных данных для аватара (CWE-73):** переменная `$avatar` не проверяется на безопасность.  
7. **Необработанные ошибки базы данных (CWE-209):** ошибки базы данных выводятся напрямую.

### 3. Разработать свою систему авторизации на любом языке, исключающий взможность подбора паролей разработнным переборщиком паролей в задании
- файл upgraded_login.php
#### Внесённые исправления:
1. **SQL-инъекции:** использованы подготовленные выражения через `PDO` для безопасного выполнения запросов.  
2. **Хранение паролей:** вместо MD5 используется `password_hash` для надёжного хэширования и `password_verify` для проверки.  
3. **Ограничение попыток входа:** добавлено ограничение — не более 5 попыток входа за 5 минут.  
4. **Защита от XSS:** все пользовательские данные экранируются с использованием `htmlspecialchars`.  
5. **Безопасное управление сессиями:** реализована безопасная работа с сессиями для отслеживания попыток входа.
